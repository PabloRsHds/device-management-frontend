<!-- Device Analysis Modal -->
<div class="analysis-modal">
  <div class="modal-content">

    <!-- Header -->
    <div class="modal-header">
      <div class="header-content">
        <h1 class="device-title">
          <span class="bar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chart-column-increasing-icon lucide-chart-column-increasing">
              <path style="color: rgb(252, 227, 3)" d="M13 17V9"/>
              <path style="color: rgb(24, 202, 8)" d="M18 17V5"/>
              <path d="M3 3v16a2 2 0 0 0 2 2h16"/>
              <path style="color: rgb(235, 41, 7)"  d="M8 17v-3"/>
            </svg>
          </span>
          Device Analysis: <span class="device-model">{{analysis.name}}</span>
        </h1>
        <p class="device-subtitle">Configuration, monitoring and history</p>
      </div>
      <div class="header-actions">
        <button class="action-btn reload-btn" (click)="reloadAnalysis()" title="Reload data">
          <span class="icon-reload">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" fill="currentColor">
              <path d="M129.9 292.5C143.2 199.5 223.3 128 320 128C373 128 421 149.5 455.8 184.2C456 184.4 456.2 184.6 456.4 184.8L464 192L416.1 192C398.4 192 384.1 206.3 384.1 224C384.1 241.7 398.4 256 416.1 256L544.1 256C561.8 256 576.1 241.7 576.1 224L576.1 96C576.1 78.3 561.8 64 544.1 64C526.4 64 512.1 78.3 512.1 96L512.1 149.4L500.8 138.7C454.5 92.6 390.5 64 320 64C191 64 84.3 159.4 66.6 283.5C64.1 301 76.2 317.2 93.7 319.7C111.2 322.2 127.4 310 129.9 292.6zM573.4 356.5C575.9 339 563.7 322.8 546.3 320.3C528.9 317.8 512.6 330 510.1 347.4C496.8 440.4 416.7 511.9 320 511.9C267 511.9 219 490.4 184.2 455.7C184 455.5 183.8 455.3 183.6 455.1L176 447.9L223.9 447.9C241.6 447.9 255.9 433.6 255.9 415.9C255.9 398.2 241.6 383.9 223.9 383.9L96 384C87.5 384 79.3 387.4 73.3 393.5C67.3 399.6 63.9 407.7 64 416.3L65 543.3C65.1 561 79.6 575.2 97.3 575C115 574.8 129.2 560.4 129 542.7L128.6 491.2L139.3 501.3C185.6 547.4 249.5 576 320 576C449 576 555.7 480.6 573.4 356.5z"/>
            </svg>
          </span>
          Reload
        </button>
        <button class="action-btn disable-btn" (click)="desactiveDevice(analysis.deviceModel)" title="Disable device">
          <span class="icon-pause">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" fill="currentColor">
              <path d="M176 96C149.5 96 128 117.5 128 144L128 496C128 522.5 149.5 544 176 544L240 544C266.5 544 288 522.5 288 496L288 144C288 117.5 266.5 96 240 96L176 96zM400 96C373.5 96 352 117.5 352 144L352 496C352 522.5 373.5 544 400 544L464 544C490.5 544 512 522.5 512 496L512 144C512 117.5 490.5 96 464 96L400 96z"/>
            </svg>
          </span>
          Disable
        </button>
        <button class="close-btn" (click)="closeModalAnalysis()" title="Close modal">
          <span>Ã—</span>
        </button>
      </div>
    </div>

    <!-- Cards Grid -->
    <div class="modal-cards">

      <!-- Current Settings Card -->
      <div class="card card-settings">
        <div class="card-header">
          <h2 class="card-title">
            <span class="icon-gear">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" fill="currentColor">
                <path d="M259.1 73.5C262.1 58.7 275.2 48 290.4 48L350.2 48C365.4 48 378.5 58.7 381.5 73.5L396 143.5C410.1 149.5 423.3 157.2 435.3 166.3L503.1 143.8C517.5 139 533.3 145 540.9 158.2L570.8 210C578.4 223.2 575.7 239.8 564.3 249.9L511 297.3C511.9 304.7 512.3 312.3 512.3 320C512.3 327.7 511.8 335.3 511 342.7L564.4 390.2C575.8 400.3 578.4 417 570.9 430.1L541 481.9C533.4 495 517.6 501.1 503.2 496.3L435.4 473.8C423.3 482.9 410.1 490.5 396.1 496.6L381.7 566.5C378.6 581.4 365.5 592 350.4 592L290.6 592C275.4 592 262.3 581.3 259.3 566.5L244.9 496.6C230.8 490.6 217.7 482.9 205.6 473.8L137.5 496.3C123.1 501.1 107.3 495.1 99.7 481.9L69.8 430.1C62.2 416.9 64.9 400.3 76.3 390.2L129.7 342.7C128.8 335.3 128.4 327.7 128.4 320C128.4 312.3 128.9 304.7 129.7 297.3L76.3 249.8C64.9 239.7 62.3 223 69.8 209.9L99.7 158.1C107.3 144.9 123.1 138.9 137.5 143.7L205.3 166.2C217.4 157.1 230.6 149.5 244.6 143.4L259.1 73.5zM320.3 400C364.5 399.8 400.2 363.9 400 319.7C399.8 275.5 363.9 239.8 319.7 240C275.5 240.2 239.8 276.1 240 320.3C240.2 364.5 276.1 400.2 320.3 400z"/>
              </svg>
            </span>
            Current Settings
          </h2>
          <span class="card-badge active">ACTIVE</span>
        </div>
        <div class="card-body">
          <div class="setting-item">
            <span class="setting-label">Min Limit</span>
            <span class="setting-value">{{analysis.minLimit}} {{analysis.unit}}</span>
          </div>
          <div class="separator"></div>

          <div class="setting-item">
            <span class="setting-label">Max Limit</span>
            <span class="setting-value">{{analysis.maxLimit}} {{analysis.unit}}</span>
          </div>
          <div class="separator"></div>

          <div class="setting-item">
            <span class="setting-label">Unit</span>
            <span class="setting-value unit-badge">{{analysis.unit}}</span>
          </div>
          <div class="separator"></div>

          <div class="setting-item">
            <span class="setting-label">Created At</span>
            <span class="setting-value">{{analysis.createdAt}}</span>
          </div>
          <div class="separator"></div>

          <div class="setting-item">
            <span class="setting-label">Updated At</span>
            <span class="setting-value">{{analysis.updatedAt}}</span>
          </div>
        </div>
      </div>

      <!-- Previous Configuration Card -->
      <div class="card card-history">
        <div class="card-header">
          <h2 class="card-title">
            <span class="icon-clipboard">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard-list-icon lucide-clipboard-list">
                <rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
                <path d="M12 11h4"/><path d="M12 16h4"/><path d="M8 11h.01"/><path d="M8 16h.01"/>
              </svg>
            </span>
            Previous Configuration
          </h2>
          <span class="card-badge history">HISTORY</span>
        </div>
        <div class="card-body">
          <div class="setting-item">
            <span class="setting-label">Min Limit</span>
            <span class="setting-value">{{analysis.lastReadingMinLimit}} {{analysis.unit}}</span>
          </div>
          <div class="separator"></div>

          <div class="setting-item">
            <span class="setting-label">Max Limit</span>
            <span class="setting-value">{{analysis.lastReadingMaxLimit}} {{analysis.unit}}</span>
          </div>
          <div class="separator"></div>

          <div class="setting-item">
            <span class="setting-label">Unit</span>
            <span class="setting-value unit-badge">{{analysis.unit}}</span>
          </div>
          <div class="separator"></div>

          <div class="setting-item">
            <span class="setting-label">Last Updated</span>
            <span class="setting-value">{{analysis.lastReadingUpdateAt}}</span>
          </div>
        </div>
      </div>

      <!-- Operation Status Card -->
      <div class="card card-chart">
        <div class="card-header">
          <h2 class="card-title">
            <span class="icon-char-pie">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chart-pie-icon lucide-chart-pie">
                <path style="stroke: #1b5fdd;" d="M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z"/>
                <path style="stroke: #8f8f8f;" d="M21.21 15.89A10 10 0 1 1 8 2.83"/>
              </svg>
            </span>
            Operation Status
          </h2>
        </div>
        <div class="card-body chart-container">
          <div echarts [options]="chartOptions" class="chart"></div>
        </div>
      </div>

    </div>


  </div>
</div>
